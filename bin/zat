#!/bin/bash

# zat - Zellij Attach or create session
#
# Attaches to an existing zellij session named after the current directory,
# or creates a new session if one doesn't exist.
#
# Usage:
#   zat        # Use current directory name as session name
#   zat foo    # Use "foo" as session name

set -e

session_name() {
  if [ -n "$1" ]; then
    echo "$1"
  else
    basename "$PWD" | tr . -
  fi
}

session="$(session_name "$1")"

if zellij list-sessions 2>/dev/null | grep -q "^$session"; then
  zellij attach "$session"
else
  zellij --session "$session" --layout compact
fi
